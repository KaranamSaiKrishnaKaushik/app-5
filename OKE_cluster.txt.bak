
Open cloud shell CLI:
Create your public/private rsa key pair.
kaushik_ke@cloudshell: ssh-keygen -t rsa -b 4096 -f ~/.ssh/bastion-key
 
 Either give it a password or skip (you need this password everytime you enter into your bastion.)
 You need to enter the same password twice.
 Once the public/private rsa key pair is generated, you can navigate to that folder via command:
cd ~/.ssh

then it will take you to 
kaushik_ke@cloudshell:.ssh (eu-frankfurt-1)$

To List and see your keys
kaushik_ke@cloudshell:.ssh (eu-frankfurt-1)$ ls
bastion-key  bastion-key.pub

PRIVATE_KEY: bastion-key
PUBLIC_KEY: bastion-key.pub

To see what the values are you can do "cat bastion-key"

Create Session:
oci bastion session create-managed-ssh --bastion-id ocid1.bastion.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaansnnuhf6zknv6yag7nks4dqshqpxbltcagt3xw72ypdq --ssh-public-key-file bastion-key.pub --target-resource-id ocid1.instance.oc1.eu-frankfurt-1.antheljt7mvzyeacn7tkekdlpz5wf5naih6u5fymxuhq2qcm66rqijhavjyq --target-os-username opc --session-ttl 1800

Check if session is ACTIVE yet:
-Replae the session-id with the data of "id" from the output(should have "bastionsession" keyword in it)
oci bastion session get --session-id ocid1.bastionsession.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaawufbhtdfzojxb3ub66p7dij4cbgbqzm5cjkjjm3lmlbq

Get command to do SSH into the node: (apending this to the above command " | jq '.data."ssh-metadata".command'"):
oci bastion session get --session-id ocid1.bastionsession.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaawufbhtdfzojxb3ub66p7dij4cbgbqzm5cjkjjm3lmlbq | jq '.data."ssh-metadata".command'

Copy the SSH command and replace <privateKey> with bastion-key:
-After replacing the command should look something like bellow. Also remove any leading Forward slashes before executing the command. 
-Also remove -p 22 from the suggestion
ssh -i bastion-key -o ProxyCommand="ssh -i bastion-key -W %h:%p -p 22 ocid1.bastionsession.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaafigrwpnoijj7wfpzgygpmmgmsq5pegqqoguxk5bqhtoq@host.bastion.eu-frankfurt-1.oci.oraclecloud.com" opc@10.0.10.161


=>Enter your password for the bastion "Frankfurt@123"
Enter passphrase for key 'bastion-key': 
Enter passphrase for key 'bastion-key': 
Activate the web console with: systemctl enable --now cockpit.socket

Last login: Sun Oct 26 18:53:42 2025 from 10.0.0.7
[opc@oke-czqrz3c34aa-nh63giznjgq-spsavbatzqq-2 ~]$ ls
app-5
[opc@oke-czqrz3c34aa-nh63giznjgq-spsavbatzqq-2 ~]$ cd app-5/
[opc@oke-czqrz3c34aa-nh63giznjgq-spsavbatzqq-2 app-5]$ ls
angular-app-5  docker-compose.yaml  dotnet-app-5  k8s


----------You are finally into the machine and now you can play arround---------------Session is open only for 1800 seconds. Once it is closed you need to repeat the process to re open it. 

sudo yum update -y
sudo yum install git -y
git --version

git clone https://github.com/KaranamSaiKrishnaKaushik/app-5.git
cd app-5/k8s

# Apply the argocd-app.yaml
kubectl apply -f argocd-app.yaml
======================================================================================================================================================================

oci bastion session create-managed-ssh \
  --bastion-id ocid1.bastion.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaansnnuhf6zknv6yag7nks4dqshqpxbltcagt3xw72ypdq \
  --ssh-public-key-file bastion-key.pub \
  --target-resource-id ocid1.instance.oc1.eu-frankfurt-1.antheljt7mvzyeacn7tkekdlpz5wf5naih6u5fymxuhq2qcm66rqijhavjyq \
  --target-os-username opc
  
oci bastion session create-managed-ssh --bastion-id ocid1.bastion.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaansnnuhf6zknv6yag7nks4dqshqpxbltcagt3xw72ypdq --ssh-public-key-file bastion-key.pub --target-resource-id ocid1.instance.oc1.eu-frankfurt-1.antheljt7mvzyeacn7tkekdlpz5wf5naih6u5fymxuhq2qcm66rqijhavjyq --target-os-username opc

oci bastion session create-managed-ssh --bastion-id ocid1.bastion.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaansnnuhf6zknv6yag7nks4dqshqpxbltcagt3xw72ypdq --ssh-public-key-file bastion-key.pub --target-resource-id ocid1.instance.oc1.eu-frankfurt-1.antheljt7mvzyeacn7tkekdlpz5wf5naih6u5fymxuhq2qcm66rqijhavjyq --target-os-username opc --max-session-ttl 43200

ocid1.bastionsession.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaawufbhtdfzojxb3ub66p7dij4cbgbqzm5cjkjjm3lmlbq

oci bastion session get --session-id <session_OCID> | jq '.data."ssh-metadata".command'

oci bastion session get --session-id ocid1.bastionsession.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaawufbhtdfzojxb3ub66p7dij4cbgbqzm5cjkjjm3lmlbq | jq '.data."ssh-metadata".command'

oci bastion session get --session-id ocid1.bastion.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaansnnuhf6zknv6yag7nks4dqshqpxbltcagt3xw72ypdq | jq '.data."ssh-metadata".command'

ssh -i bastion-key -o ProxyCommand=\"ssh -i bastion-key -W %h:%p -p 22 ocid1.bastionsession.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaawufbhtdfzojxb3ub66p7dij4cbgbqzm5cjkjjm3lmlbq@host.bastion.eu-frankfurt-1.oci.oraclecloud.com\" -p 22 opc@10.0.10.161

ocid1.bastionsession.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaavixfmrihcyemlzblfih4nky77q22qemugdvnde7kaqua@host.bastion.eu-frankfurt-1.oci.oraclecloud.com\

ssh -i bastion-key -o ProxyCommand="ssh -i bastion-key -W %h:%p -p 22 ocid1.bastionsession.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaavixfmrihcyemlzblfih4nky77q22qemugdvnde7kaqua@host.bastion.eu-frankfurt-1.oci.oraclecloud.com" opc@10.0.10.161

ssh -i <privateKey> -o ProxyCommand=\"ssh -i <privateKey> -W %h:%p -p 22 ocid1.bastionsession.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaavixfmrihcyemlzblfih4nky77q22qemugdvnde7kaqua@host.bastion.eu-frankfurt-1.oci.oraclecloud.com\" -p 22 opc@10.0.10.161

ssh -i bastion-key -o ProxyCommand=\"ssh -i bastion-key -W %h:%p -p 22 ocid1.bastionsession.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaafigrwpnoijj7wfpzgygpmmgmsq5pegqqoguxk5bqhtoq@host.bastion.eu-frankfurt-1.oci.oraclecloud.com" -p 22 opc@10.0.10.161

oci bastion session create-managed-ssh \
  --bastion-id <bastion OCID> \
  --ssh-public-key-file <ssh public key> \
  --target-resource-id <worker node instance OCID> \
  --target-os-username <instance_username>
  
  
  oci bastion session create-managed-ssh \
  --bastion-id Bastion202510221 \
  --ssh-public-key-file <ssh public key> \
  --target-resource-id ocid1.bastion.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaaq3znj7hetw2iw7vhov3tjog5nnfeexl42gayvlmhzxqq \
  --target-os-username <instance_username>
  
  ssh -i /home/johndoe/.ssh/id_rsa -o ProxyCommand="ssh -i /home/johndoe/.ssh/id_rsa -W %h:%p -p 22 ocid1.bastion.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaaq3znj7hetw2iw7vhov3tjog5nnfeexl42gayvlmhzxqq" -p 22 opc@10.0.0.14 &
  
  
  bastionID: ocid1.bastion.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaaq3znj7hetw2iw7vhov3tjog5nnfeexl42gayvlmhzxqq
  ssh public key: id_rsa.pub
  target-resource-id: ocid1.instance.oc1.eu-frankfurt-1.antheljt7mvzyeacn7tkekdlpz5wf5naih6u5fymxuhq2qcm66rqijhavjyq
  instance_username: opc
  
  
  oci bastion session create-managed-ssh --bastion-id ocid1.bastion.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaaq3znj7hetw2iw7vhov3tjog5nnfeexl42gayvlmhzxqq --ssh-public-key-file ssh-key-2025-10-22.key.pub --target-resource-id ocid1.instance.oc1.eu-frankfurt-1.antheljt7mvzyeacn7tkekdlpz5wf5naih6u5fymxuhq2qcm66rqijhavjyq --target-os-username opc
  
  
  
  {
  "data": {
    "bastion-id": "ocid1.bastion.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaaq3znj7hetw2iw7vhov3tjog5nnfeexl42gayvlmhzxqq",
    "bastion-name": "Bastion202510221",
    "bastion-public-host-key-info": null,
    "bastion-user-name": null,
    "display-name": "bastionsession2025-10-22-1159",
    "id": "ocid1.bastionsession.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaakdvvj3cowdkqygz4b5fdavq752o5r4wewywhgnshmfrq",
    "key-details": {
      "public-key-content": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAMbPVfhf7Lzv6yo2M0najiglskmPCpRyYD9NczHHOaN/iGcQdxd1GKvMpCQgkGJvpUyrPj0v98eeaG9JLUH7D8ezodUTzXzJbSdnnkWh/C6FEzW8Ggd7Fe9uLzogr+TzJ7ryTpRWd34u46q1sleekAppUyUgP9PRpjKp+skYbt2CgIiFg/3WBumNY9moOHbHstmmF8TH9YzPULRQ20ZULnZHJAf07GVEWvSXpxGygAx0KenUiiAQqcLUfp/nN0TISsYHUIFB2V3m/h3YxICXgaNZhHltHvwJ10LTDtz5myZzPfy0QlA1bhIy+v756oOIvHnRSPjS9Bu+eVuVHE2fDs0= ssh-key-2025-10-22"
    },
    "key-type": "PUB",
    "lifecycle-details": null,
    "lifecycle-state": "CREATING",
    "session-ttl-in-seconds": 1800,
    "ssh-metadata": null,
    "target-resource-details": {
      "session-type": "MANAGED_SSH",
      "target-resource-display-name": "oke-czqrz3c34aa-nh63giznjgq-spsavbatzqq-2",
      "target-resource-id": "ocid1.instance.oc1.eu-frankfurt-1.antheljt7mvzyeacn7tkekdlpz5wf5naih6u5fymxuhq2qcm66rqijhavjyq",
      "target-resource-operating-system-user-name": "opc",
      "target-resource-port": 22,
      "target-resource-private-ip-address": "10.0.10.161"
    },
    "time-created": "2025-10-22T15:18:54.640000+00:00",
    "time-updated": "2025-10-22T15:18:54.640000+00:00"
  },
  "opc-work-request-id": "ocid1.bastionworkrequest.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaa7cydnyvz3vlqxnyhk43o2yadrgbt5i4t7ok3uvequkoq"
}
PS C:\Users\KaranamK\OracleCloud_Instance_Information\22102025>


oci bastion session create-managed-ssh 
--bastion-id ocid1.bastion.oc1.eu-frankfurt-1.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxqq 
--ssh-public-key-file .\ssh-key-2025-10-22.key.pub 
--target-resource-id ocid1.instance.oc1.eu-frankfurt-1.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxjhavjyq 
--target-os-username opc

oci bastion session get --session-id ocid1.bastionsession.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaakdvvj3cowdkqygz4b5fdavq752o5r4wewywhgnshmfrq --query "data"

ssh -i <privateKey> -o ProxyCommand=\"ssh -i <privateKey> -W %h:%p -p 22 ocid1.bastionsession.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaakdvvj3cowdkqygz4b5fdavq752o5r4wewywhgnshmfrq@host.bastion.eu-frankfurt-1.oci.oraclecloud.com\" -p 22 opc@10.0.10.161



ssh -i "C:\Users\KaranamK\OracleCloud_Instance_Information\22102025\ssh-key-2025-10-22.key" `
  -o ProxyCommand="ssh -i C:\Users\KaranamK\OracleCloud_Instance_Information\22102025\ssh-key-2025-10-22.key -W %h:%p -p 22 ocid1.bastionsession.oc1.eu-frankfurt-1.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxqq@host.bastion.eu-frankfurt-1.oci.oraclecloud.com" `
  -p 22 opc@10.0.10.161


PS C:\Users\KaranamK\OracleCloud_Instance_Information\22102025> ssh -i ".\ssh-key-2025-10-22.key" -o ProxyCommand=\"ssh -i .\ssh-key-2025-10-22.key -W %h:%p -p 22 ocid1.bastionsession.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaakdvvj3cowdkqygz4b5fdavq752o5r4wewywhgnshmfrq@host.bastion.eu-frankfurt-1.oci.oraclecloud.com\" -p 22 opc@10.0.10.161
command-line line 0: invalid quotes


ssh-keygen -i -m PKCS8 -f C:\Users\KaranamK\.oci\ssh-key-2025-10-22.key.pub > C:\Users\KaranamK\.oci\ssh-key-2025-10-22.openssh.pub


ssh -i "C:\Users\KaranamK\.oci\ssh-key-2025-10-22.openssh.pub" -o ProxyCommand=\"ssh -i C:\Users\KaranamK\.oci\ssh-key-2025-10-22.openssh.pub -W %h:%p -p 22 ocid1.bastionsession.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaakdvvj3cowdkqygz4b5fdavq752o5r4wewywhgnshmfrq@host.bastion.eu-frankfurt-1.oci.oraclecloud.com\" -p 22 opc@10.0.10.161
command-line line 0: invalid quotes


C:\Users\KaranamK\OracleCloud_Instance_Information\22102025

This worked but wrong ssh-key it should be the same one while creating bastion.
ssh -i "C:\Users\KaranamK\OracleCloud_Instance_Information\22102025\ssh-key-2025-10-22.key" -o 'ProxyCommand=oci bastion session connect --session-id ocid1.bastionsession.oc1.eu-frankfurt-1.amaaaaaa7mvzyeaakdvvj3cowdkqygz4b5fdavq752o5r4wewywhgnshmfrq@host.bastion.eu-frankfurt-1.oci.oraclecloud.com' -p 22 opc@10.0.10.161